async function register(){const r=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:name.value,phone:phone.value})});const d=await r.json();alert(`ID: ${d.userId} Password: ${d.password}`)}async function login(){const r=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:userId.value,password:password.value})});const d=await r.json();if(d.role==="admin")location.href="admin.html";else{localStorage.user=JSON.stringify(d);location.href="dashboard.html"}}async function sell(){const u=JSON.parse(localStorage.user);await fetch("/api/farmer/sell",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sellerId:u.userId})});loadDashboard()}async function loadDashboard(){const u=JSON.parse(localStorage.user);const r=await fetch(`/api/farmer/${u.userId}`);const d=await r.json();data.innerHTML=`Bags: ${d.totalBags} | Profit: ৳${d.profit}`}if(location.pathname.includes("dashboard"))loadDashboard();function logout(){localStorage.clear();location.href="/"}if(location.pathname.includes("admin")){fetch("/api/admin/stats").then(r=>r.json()).then(d=>{stats.innerHTML=`Users: ${d.users}<br>Bags: ${d.bags}<br>Profit: ৳${d.totalProfit}`})}
